{
  "name": "rooster-app-final",
  "version": "0.1.15-draad420",
  "private": true,
  "scripts": {
    "dev": "next dev",
    "build": "next build --no-lint && node scripts/postbuild.js",
    "start": "HOSTNAME=0.0.0.0 PORT=${PORT:-3000} node .next/standalone/server.js",
    "lint": "next lint"
  },
  "dependencies": {
    "@supabase/supabase-js": "^2.78.0",
    "date-fns": "^4.1.0",
    "date-fns-tz": "^3.2.0",
    "jspdf": "^2.5.1",
    "lucide-react": "^0.548.0",
    "next": "^14.2.35",
    "react": "18.3.1",
    "react-dom": "18.3.1",
    "react-hot-toast": "^2.4.1",
    "xlsx": "^0.18.5",
    "zustand": "^5.0.8"
  },
  "devDependencies": {
    "@types/node": "^20",
    "@types/react": "^18",
    "@types/react-dom": "^18",
    "autoprefixer": "^10.4.19",
    "eslint": "^8.57.0",
    "eslint-config-next": "14.2.35",
    "postcss": "^8.4.40",
    "tailwindcss": "^3.4.1",
    "typescript": "^5"
  },
  "engines": {
    "node": ">=20.0.0",
    "npm": ">=10.0.0"
  },
  "_deploy_metadata": {
    "timestamp": "2026-01-19T16:50:43Z",
    "draad": "DRAAD420_UINT8ARRAY_AND_DEPENDENCY_CLEANUP",
    "version": "0.1.15-draad420",
    "cache_bust": true,
    "cache_bust_id": "1737298243",
    "date_now": 1737298243000,
    "railway_trigger": "FORCE_REBUILD_DRAAD420_K9M8",
    "deployment_strategy": "hotfix-buffer-type-mismatch",
    "fixes": [
      "[DRAAD420-FIX-PRIORITY-1] KRITIEKE FIX: NextResponse Buffer type mismatch",
      "PROBLEEM: Type 'Buffer<ArrayBufferLike>' niet compatibel met BodyInit",
      "OORZAAK: NextResponse verwacht Web API BodyInit (Blob, ArrayBuffer, Uint8Array, etc)",
      "VOOR FIX: Buffer.from(pdf.output('arraybuffer')) → Node.js type",
      "OPLOSSING: Uint8Array (Web API BufferSource) ✅",
      "CODE: const pdfUint8Array = new Uint8Array(pdf.output('arraybuffer'))",
      "RESULT: NextResponse(pdfUint8Array) ✅ compatible",
      "[DRAAD420-FIX-PRIORITY-2] jsPDF import statement",
      "VOOR: import jsPDF from 'jspdf' (ambiguous)",
      "AFTER: import { jsPDF } from 'jspdf' (explicit ES6)",
      "[DRAAD420-FIX-PRIORITY-3] Deprecated dependency removal",
      "REMOVED: @supabase/auth-helpers-nextjs (EOL, deprecated)",
      "REASON: Package marked as deprecated, use @supabase/ssr instead",
      "[DRAAD420-FIX-PRIORITY-4] Unused package cleanup",
      "REMOVED: html2canvas ^1.4.1 (old PDF approach, not used)",
      "REMOVED: canvg ^2.0.0 (canvas polyfill, not used)",
      "REMOVED: jspdf-autotable ^3.8.2 (manual tables in use)",
      "RESULT: Cleaner node_modules, faster npm install",
      "Build ID: DRAAD420-FIX-UINT8ARRAY-1737298243",
      "File location: src/app/api/afl/export/pdf/route.ts",
      "Key change: Buffer → Uint8Array at line 413",
      "Key change: NextResponse(pdfUint8Array) at line 497",
      "Function return type: Promise<Uint8Array>",
      "Type safety: Full TypeScript strict mode compliance",
      "Version bump: 0.1.14 → 0.1.15-draad420",
      "Timestamp: 2026-01-19T16:50:43Z",
      "Expected result: npm run build PASSES without type errors",
      "Build-time behavior: No TypeScript errors on line 497",
      "Runtime behavior: PDF generation & export unchanged",
      "File download: Works correctly with proper headers",
      "Cache headers: No-cache enforcement (cache-bust active)"
    ],
    "status": "READY_FOR_DEPLOYMENT",
    "deployment_attempt": 1,
    "reason": "Type mismatch fix + dependency cleanup",
    "random_trigger": "K9M8",
    "verification_required": true,
    "previous_error": "Type 'Buffer<ArrayBufferLike>' is not assignable to 'BodyInit'",
    "fix_applied": "Changed pdf.output('arraybuffer') to Uint8Array for Web API compatibility",
    "test_queries": [
      "npm run build -- should PASS with no TypeScript errors",
      "POST /api/afl/export/pdf with valid afl_run_id -- should return PDF",
      "GET /api/afl/export/pdf?afl_run_id=<uuid> -- should return PDF",
      "PDF download should work in browser (Content-Disposition header)",
      "PDF size should be correct in Content-Length header"
    ]
  }
}
