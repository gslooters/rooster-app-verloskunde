[build]
# Clean build command
command = "npm ci && npm run build"

[deploy]
# DRAAD182 FIX: Use sh instead of bash for Alpine Linux compatibility
# Alpine (node:20-alpine) uses ash (sh), not GNU bash
# sh is POSIX-compliant and supports all required syntax
startCommand = "sh -c 'HOSTNAME=0.0.0.0 PORT=$PORT node .next/standalone/server.js'"

# Health check
healthcheckPath = "/api/health"
healthcheckTimeout = 100

# Restart policy
restartPolicyType = "ON_FAILURE"
restartPolicyMaxRetries = 10

# === FIX HISTORY ===
# 2025-12-15T20:44:46 DRAAD182: bash not found in Alpine container
# Root cause: Dockerfile uses node:20-alpine (minimal Linux distro)
#             Alpine includes sh but NOT bash
# Solution: Use 'sh -c' instead of 'bash -c'
# Status: DEPLOYED & VERIFIED